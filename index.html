<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wallet Connect - BSC</title>
  
  <!-- Web3.js Library -->
  <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
  
  <!-- WalletConnect Provider Library -->
  <script src="https://unpkg.com/@walletconnect/web3-provider@1.6.6/dist/umd/index.min.js"></script>
</head>
<body>
  <button id="connectWalletButton">Connect Wallet</button>
  <p id="walletAddress">Wallet Address: Not Connected</p>

  <script type="text/javascript">
    const connectWalletButton = document.getElementById("connectWalletButton");
    const walletAddressDisplay = document.getElementById("walletAddress");

    // Function to connect the wallet using either MetaMask or WalletConnect
    async function connectWallet() {
      // Check if MetaMask (window.ethereum) is available
      if (window.ethereum) {
        try {
          // Request accounts from MetaMask
          const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
          const walletAddress = accounts[0];
          walletAddressDisplay.textContent = `Wallet Address: ${walletAddress}`;
          console.log("Connected with MetaMask: ", walletAddress);
        } catch (error) {
          console.error("User rejected request");
        }
      } else {
        // If MetaMask is not available, use WalletConnect
        const provider = new WalletConnectProvider({
          rpc: {
            56: "https://bsc-dataseed.binance.org/",  // Mainnet BSC public node
          },
        });

        // Enable WalletConnect session (opens QR code or deep link)
        await provider.enable();

        // Use Web3.js to interact with the blockchain via WalletConnect
        const web3 = new Web3(provider);
        const accounts = await web3.eth.getAccounts();
        const walletAddress = accounts[0];
        walletAddressDisplay.textContent = `Wallet Address: ${walletAddress}`;
        console.log("Connected with WalletConnect: ", walletAddress);
      }
    }

    // Add click event listener to connect wallet button
    connectWalletButton.addEventListener('click', connectWallet);
  </script>
</body>
</html>
